<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WaterThePlant | Home</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-image: url('img/general/space.jpeg');
            background-size: cover;
            background-position: center;
            transition: background-color 0.3s ease;
        }

        body.dark-mode {
            background-color: #2c2f38;
            color: #fff;
        }

        /* Make icon buttons circular */
        .icon-button {
            border-radius: 50%;
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            padding: 0;
            background: transparent;
            border: none;
        }

        /* Dark mode styling for the navbar */
        .navbar.dark-mode {
            background-color: #333 !important;
        }
        .navbar.dark-mode .navbar-brand,
        .navbar.dark-mode .nav-link,
        .navbar.dark-mode .navbar-toggler-icon {
            color: #fff !important;
        }

        .widget {
            position: absolute;
            width: 300px;
            height: 300px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 10px;
            cursor: grab;
            display: none;
            transition: background-color 0.3s, color 0.3s;
            overflow: hidden;
            box-sizing: border-box;
        }

        .widget h4 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        body.dark-mode .widget {
            background-color: #444;
            color: #fff;
            border-color: #666;
        }

        .content-section {
            background: rgba(255,255,255,0.8);
            padding: 40px;
            border-radius: 8px;
            margin-top: 100px;
        }

        .content-section h2 {
            text-align: center;
            font-size: 2.5rem;
        }

        .content-section p {
            font-size: 1.1rem;
            line-height: 1.6;
            text-align: center;
        }

        .feature-list {
            margin-top: 40px;
            display: flex;
            justify-content: center;
            gap: 50px;
            flex-wrap: wrap;
        }

        .feature-item {
            width: 250px;
            text-align: center;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 300px;
        }

        .feature-item h4 {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        body.dark-mode .feature-item {
            background-color: #555;
            color: #fff;
            border-color: #666;
        }

        .button-container {
            text-align: center;
            margin-top: auto;
        }

        .button-container button {
            width: 100px;
        }

        #pomodoroDisplay {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 10px;
        }

        #todoList, #showNotes {
            width: 100%;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 5px;
            box-sizing: border-box;
        }

        #todoList {
            height: 150px;
        }

        #showNotes {
            height: 80px;
        }

        .draggable-item {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 10px;
            margin-bottom: 5px;
            cursor: grab;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        body.dark-mode .draggable-item {
            background: #333;
            border-color: #444;
            color: #fff;
        }

        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .drag-over {
            border: 2px dashed #317773;
        }
    </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    <a class="navbar-brand" href="index.html">
        <img id="logo" src="img/general/logowhite.png" alt="Logo" height="50">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="notes.html">Notes</a></li>
            <li class="nav-item"><a class="nav-link" href="pomodoro.html">Pomodoro</a></li>
            <li class="nav-item"><a class="nav-link" href="todos.html">To-Do List</a></li>
        </ul>
        <button class="icon-button" id="colorToggle" aria-label="Change Color" onclick="toggleDarkMode()">üé®</button>
        <button class="icon-button" id="languageToggle" aria-label="Select Language">üåê</button>
        <div class="dropdown">
            <button class="icon-button" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">...
            </button>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton"></div>
        </div>
    </div>
</nav>

<!-- Main Content Area -->
<div class="container mt-4">
    <div class="content-section">
        <h2>Welcome to WaterThePlant</h2>
        <p>WaterThePlant is your all-in-one productivity companion. Keep track of tasks, record notes, and focus with the Pomodoro technique‚Äîall from one place. For more detailed insights and methods, visit the dedicated pages for each feature.</p>

        <div class="feature-list">
            <!-- Pomodoro Section (Main Page) -->
            <div class="feature-item">
                <h4>Pomodoro Timer</h4>
                <p>Focus in short sprints and stay productive.</p>
                <div class="button-container">
                    <button class="btn btn-primary" id="pomodoroToggleBtn" onclick="toggleWidget('widget1', this)">Try Basic</button>
                </div>
            </div>

            <!-- To-Do List Section (Main Page) -->
            <div class="feature-item">
                <h4>To-Do List</h4>
                <p>Organize tasks and never miss a deadline.</p>
                <div class="button-container">
                    <button class="btn btn-primary" id="todoToggleBtn" onclick="toggleWidget('widget2', this)">Try Basic</button>
                </div>
            </div>

            <!-- Notes Section (Main Page) -->
            <div class="feature-item">
                <h4>Notes</h4>
                <p>Capture ideas and important info in one place.</p>
                <div class="button-container">
                    <button class="btn btn-primary" id="notesToggleBtn" onclick="toggleWidget('widget3', this)">Try Basic</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pomodoro Widget -->
    <div class="widget" id="widget1" style="top: 400px; left: 10px;">
        <h4>Pomodoro</h4>
        <p> For detailed tips and advanced techniques, visit the Pomodoro Timer page.</p>
        <div id="pomodoroDisplay">25:00</div>
        <div class="button-container">
            <button class="btn btn-success" id="pomodoroStartBtn">Start</button>
            <button class="btn btn-danger" id="pomodoroStopBtn">Stop</button>
        </div>
        <p id="pomodoroMessage" style="text-align:center; color:green; font-weight:bold;"></p>
    </div>

    <!-- To-Do Widget -->
    <div class="widget" id="widget2" style="top: 400px; left: 300px;">
        <h4>To-Do List</h4>

        <input type="text" id="todoInput" class="form-control mb-2" placeholder="Add a task... (max 150 chars)">
        <div class="button-container mb-2">
            <button class="btn btn-primary" id="addTodoBtn">Add</button>
        </div>
        <div id="todoList"></div>
    </div>

    <!-- Notes Widget -->
    <div class="widget" id="widget3" style="top: 400px; left: 600px;">
        <h4>Notes</h4>

        <input id="input-title" type="text" placeholder="Title (max 150 chars total)" class="form-control mb-2">
        <textarea id="input-text" placeholder="Text (Title+Text ‚â§ 150 chars)" class="form-control mb-2"></textarea>
        <div class="button-container mb-2">
            <button id="addNoteBtn" class="btn btn-primary">Add</button>
        </div>
        <div id="showNotes"></div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Dark Mode Toggle
    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        document.querySelector('.navbar').classList.toggle('dark-mode');

        const logo = document.getElementById('logo');
        if (document.body.classList.contains('dark-mode')) {
            logo.src = 'img/general/logowhite.png';
        } else {
            logo.src = 'img/general/logoblack.png';
        }
    }

    // Initialize widget states
    function initializeWidgetStates() {
        if (!sessionStorage.getItem('widget1Open')) {
            sessionStorage.setItem('widget1Open', 'false');
        }
        if (!sessionStorage.getItem('widget2Open')) {
            sessionStorage.setItem('widget2Open', 'false');
        }
        if (!sessionStorage.getItem('widget3Open')) {
            sessionStorage.setItem('widget3Open', 'false');
        }
    }

    initializeWidgetStates();

    function toggleWidget(widgetId, button) {
        const widget = document.getElementById(widgetId);
        let stateKey = widgetId + 'Open';
        let isOpen = sessionStorage.getItem(stateKey) === 'true';

        if (!isOpen) {
            // Open widget
            widget.style.display = 'block';
            button.textContent = 'Close';
            sessionStorage.setItem(stateKey, 'true');
        } else {
            // Close widget
            widget.style.display = 'none';
            button.textContent = 'Try Basic';
            sessionStorage.setItem(stateKey, 'false');
        }
    }

    function restoreWidgetStates() {
        // Restore widget1
        const widget1State = sessionStorage.getItem('widget1Open');
        const widget1 = document.getElementById('widget1');
        const pomodoroToggleBtn = document.getElementById('pomodoroToggleBtn');
        if (widget1State === 'true') {
            widget1.style.display = 'block';
            pomodoroToggleBtn.textContent = 'Close';
        } else {
            widget1.style.display = 'none';
            pomodoroToggleBtn.textContent = 'Try Basic';
        }

        // Restore widget2
        const widget2State = sessionStorage.getItem('widget2Open');
        const widget2 = document.getElementById('widget2');
        const todoToggleBtn = document.getElementById('todoToggleBtn');
        if (widget2State === 'true') {
            widget2.style.display = 'block';
            todoToggleBtn.textContent = 'Close';
        } else {
            widget2.style.display = 'none';
            todoToggleBtn.textContent = 'Try Basic';
        }

        // Restore widget3
        const widget3State = sessionStorage.getItem('widget3Open');
        const widget3 = document.getElementById('widget3');
        const notesToggleBtn = document.getElementById('notesToggleBtn');
        if (widget3State === 'true') {
            widget3.style.display = 'block';
            notesToggleBtn.textContent = 'Close';
        } else {
            widget3.style.display = 'none';
            notesToggleBtn.textContent = 'Try Basic';
        }
    }

    function makeDraggable(widgetId) {
        const widget = document.getElementById(widgetId);
        let offsetX = 0, offsetY = 0;
        let isDragging = false;

        widget.addEventListener('mousedown', (e) => {
            if (['INPUT','TEXTAREA','BUTTON'].includes(e.target.tagName)) {
                return;
            }
            isDragging = true;
            offsetX = e.clientX - widget.offsetLeft;
            offsetY = e.clientY - widget.offsetTop;
            widget.style.cursor = 'grabbing';
            e.preventDefault();
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                widget.style.left = `${e.clientX - offsetX}px`;
                widget.style.top = `${e.clientY - offsetY}px`;
            }
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            widget.style.cursor = 'grab';
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        makeDraggable('widget1');
        makeDraggable('widget2');
        makeDraggable('widget3');
        restoreWidgetStates();
    });

    // Pomodoro Logic
    let pomodoroInterval;
    let pomodoroTime = 25 * 60;
    const pomodoroDisplay = document.getElementById('pomodoroDisplay');
    const pomodoroMessage = document.getElementById('pomodoroMessage');

    const pomodoroStartBtn = document.getElementById('pomodoroStartBtn');
    const pomodoroStopBtn = document.getElementById('pomodoroStopBtn');
    pomodoroStartBtn.addEventListener('click', startPomodoro);
    pomodoroStopBtn.addEventListener('click', stopPomodoro);

    function startPomodoro() {
        stopPomodoro();
        pomodoroMessage.textContent = "";
        pomodoroInterval = setInterval(() => {
            if (pomodoroTime > 0) {
                pomodoroTime--;
                updatePomodoroDisplay();
            } else {
                clearInterval(pomodoroInterval);
                pomodoroMessage.textContent = "Time's Up!";
            }
        }, 1000);
    }

    function stopPomodoro() {
        clearInterval(pomodoroInterval);
        pomodoroTime = 25 * 60;
        updatePomodoroDisplay();
    }

    function updatePomodoroDisplay() {
        const minutes = Math.floor(pomodoroTime / 60).toString().padStart(2, '0');
        const seconds = (pomodoroTime % 60).toString().padStart(2, '0');
        pomodoroDisplay.textContent = `${minutes}:${seconds}`;
    }

    // sessionStorage for To-Do and Notes
    function initializeTodoStorage() {
        if (!sessionStorage.getItem('todos')) {
            sessionStorage.setItem('todos', JSON.stringify([]));
        }
    }
    initializeTodoStorage();

    const todoList = document.getElementById('todoList');
    let todoItems = JSON.parse(sessionStorage.getItem('todos'));

    function displayTodoList() {
        todoList.innerHTML = "";
        todoItems.forEach((item, index) => {
            const todoDiv = document.createElement('div');
            todoDiv.className = 'draggable-item';
            todoDiv.textContent = item.text + " ";
            const delBtn = document.createElement('button');
            delBtn.className = 'btn btn-danger btn-sm';
            delBtn.textContent = "X";
            delBtn.style.marginLeft = "10px";
            delBtn.onclick = () => { deleteTodo(index); };
            todoDiv.appendChild(delBtn);
            todoList.appendChild(todoDiv);
        });
    }
    displayTodoList();

    const addTodoBtn = document.getElementById('addTodoBtn');
    addTodoBtn.addEventListener('click', addTodo);

    function addTodo() {
        const todoInput = document.getElementById('todoInput');
        const text = todoInput.value.trim();
        if (!text) return;

        if (text.length > 150) {
            alert("To-Do item cannot exceed 150 characters.");
            return;
        }

        todoItems.push({ text: text });
        sessionStorage.setItem('todos', JSON.stringify(todoItems));
        todoInput.value = "";
        displayTodoList();
    }

    function deleteTodo(index) {
        todoItems.splice(index, 1);
        sessionStorage.setItem('todos', JSON.stringify(todoItems));
        displayTodoList();
    }

    function initializeNotesStorage() {
        if (!sessionStorage.getItem('notes')) {
            sessionStorage.setItem('notes', JSON.stringify([]));
        }
    }

    initializeNotesStorage();
    const showNotes = document.getElementById('showNotes');
    let notes = JSON.parse(sessionStorage.getItem('notes'));

    function displayNotesList() {
        showNotes.innerHTML = "";
        notes.forEach((note, index) => {
            const noteDiv = document.createElement('div');
            noteDiv.className = 'draggable-item';

            const header = document.createElement('div');
            header.className = 'note-header';

            const titleEl = document.createElement('strong');
            titleEl.textContent = note.title;
            header.appendChild(titleEl);

            const delBtn = document.createElement('button');
            delBtn.textContent = "X";
            delBtn.className = 'btn btn-danger btn-sm';
            delBtn.style.marginLeft = "10px";
            delBtn.onclick = () => { deleteNote(index); };
            header.appendChild(delBtn);

            noteDiv.appendChild(header);

            const textEl = document.createElement('p');
            textEl.textContent = note.text;
            noteDiv.appendChild(textEl);

            showNotes.appendChild(noteDiv);
        });
    }
    displayNotesList();

    const addNoteBtn = document.getElementById('addNoteBtn');
    addNoteBtn.addEventListener('click', addNoteOnClick);

    function addNoteOnClick() {
        const titleInput = document.getElementById('input-title');
        const textInput = document.getElementById('input-text');
        const title = titleInput.value.trim();
        const text = textInput.value.trim();

        if (!title || !text) {
            alert("Please fill out both fields.");
            return;
        }

        let combined = (title + text).trim();
        if (combined.length > 150) {
            alert("Note cannot exceed 150 characters in total.");
            return;
        }

        notes.push({ title, text });
        sessionStorage.setItem('notes', JSON.stringify(notes));
        titleInput.value = "";
        textInput.value = "";
        displayNotesList();
    }

    function deleteNote(index) {
        notes.splice(index, 1);
        sessionStorage.setItem('notes', JSON.stringify(notes));
        displayNotesList();
    }
</script>
</body>
</html>
